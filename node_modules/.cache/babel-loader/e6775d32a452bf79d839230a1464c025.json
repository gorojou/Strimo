{"ast":null,"code":"var _jsxFileName = \"/home/usuario/Documentos/GitHub/Strimo/src/content/pago/formulario.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport firebase from \"../../utils/firebase\";\nimport { useAuth } from \"../context/authContext\";\nimport qr from \"../images/qr-code-example.png\";\nimport { useHistory } from \"react-router-dom\";\nimport { useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Register({\n  img,\n  moneda\n}) {\n  _s();\n\n  const {\n    id\n  } = useParams();\n  const history = useHistory();\n  const ref = useRef(null);\n  const wallet = \"6vuw9DbaenYyMjuBDn8bkH3Ny23b4s6mPPLq4dbuxZPDm EVo4TM\";\n  const [precio, setPrecio] = useState(\"\");\n  const preciobtc = \"0.0013 BTC\";\n  const precioeth = \"0.00042 ETH\";\n  const comprobante = \"224345q7iq19\";\n  const {\n    currentUser\n  } = useAuth();\n  useEffect(() => {\n    if (moneda === \"btc\") {\n      setPrecio(preciobtc);\n    } else {\n      setPrecio(precioeth);\n    }\n\n    setTimeout(() => {\n      ref.current.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    }, 500);\n  }, [moneda]);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const createChat = firebase.firestore().collection(\"Chat\");\n    const pago = firebase.firestore().collection(\"Pagos\");\n    const invitacionDoc = firebase.firestore().collection(\"Invitacion\");\n    const conciertos = firebase.firestore().collection(\"Conciertos\");\n    const notificaciones = firebase.firestore().collection(\"Notificaciones\");\n    pago.where(\"comprobante\", \"==\", comprobante).where(\"usuario\", \"==\", currentUser.uid).get().then(snapshot => {\n      let match = \"\";\n      snapshot.docs.map(async doc => {\n        match = doc.data();\n      });\n      console.log(match);\n\n      if (!match) {\n        pago.add({\n          comprobante: comprobante,\n          concierto: id,\n          usuario: currentUser.uid\n        }).then(async docRef => {\n          await conciertos.doc(id).update({\n            entradasVip: firebase.firestore.FieldValue.increment(-1)\n          });\n          await createChat.add({\n            concierto: id,\n            pago: docRef.id,\n            integrantes: [currentUser.email]\n          }).then(async doc => {\n            await invitacionDoc.add({\n              concierto: id,\n              de: currentUser.email,\n              pago: docRef.id,\n              usuarioInvitado: \"\",\n              tiempo: firebase.firestore.Timestamp.now().toMillis() + 1000 * 60 * 60 * 5,\n              chatId: doc.id\n            });\n          });\n          await notificaciones.add({\n            info: `Solicitud de compra para concierto ${id}, ha sido procesada correctamente`,\n            infoHeadLine: \"Compra procesada\",\n            usuario: currentUser.uid,\n            visto: false,\n            tiempo: firebase.firestore.Timestamp.now().toDate()\n          });\n          history.push(`/invitacion/${docRef.id}`);\n        }).catch(async error => {\n          alert(error);\n          await notificaciones.add({\n            info: `Solicitud de compra para concierto ${id}, ha devuelto un error :/`,\n            infoHeadLine: \"Error para procesar compra\",\n            usuario: currentUser.uid,\n            visto: false\n          });\n        });\n      } else {\n        history.push(`/invitacion/${comprobante}`);\n      }\n    });\n    e.preventDefault();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"form-pago\",\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      alt: \"\",\n      src: img,\n      width: \"100px\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"title\",\n      children: \"Formulario de pago\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"form-layout\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        alt: \"\",\n        src: qr,\n        width: \"250px\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: wallet,\n        readOnly: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Precio, {\n        precio: precio\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"Submit\",\n        className: \"primario\",\n        style: {\n          width: \"30%\"\n        },\n        ref: ref,\n        children: \"Entrar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Register, \"qzGmW9Dd8U9jEZAZ/zJNxhfiavw=\", false, function () {\n  return [useParams, useHistory, useAuth];\n});\n\n_c = Register;\n\nconst Precio = ({\n  precio\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"precio\",\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"Precio: \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: precio\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 5\n  }, this);\n};\n\n_c2 = Precio;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Register\");\n$RefreshReg$(_c2, \"Precio\");","map":{"version":3,"sources":["/home/usuario/Documentos/GitHub/Strimo/src/content/pago/formulario.jsx"],"names":["React","useState","useEffect","useRef","firebase","useAuth","qr","useHistory","useParams","Register","img","moneda","id","history","ref","wallet","precio","setPrecio","preciobtc","precioeth","comprobante","currentUser","setTimeout","current","scrollIntoView","behavior","handleSubmit","e","preventDefault","createChat","firestore","collection","pago","invitacionDoc","conciertos","notificaciones","where","uid","get","then","snapshot","match","docs","map","doc","data","console","log","add","concierto","usuario","docRef","update","entradasVip","FieldValue","increment","integrantes","email","de","usuarioInvitado","tiempo","Timestamp","now","toMillis","chatId","info","infoHeadLine","visto","toDate","push","catch","error","alert","width","Precio"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,MAArC,QAAmD,OAAnD;AACA,OAAOC,QAAP,MAAqB,sBAArB;AACA,SAASC,OAAT,QAAwB,wBAAxB;AACA,OAAOC,EAAP,MAAe,+BAAf;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,SAAT,QAA0B,kBAA1B;;AACA,eAAe,SAASC,QAAT,CAAkB;AAAEC,EAAAA,GAAF;AAAOC,EAAAA;AAAP,CAAlB,EAAmC;AAAA;;AAChD,QAAM;AAAEC,IAAAA;AAAF,MAASJ,SAAS,EAAxB;AACA,QAAMK,OAAO,GAAGN,UAAU,EAA1B;AACA,QAAMO,GAAG,GAAGX,MAAM,CAAC,IAAD,CAAlB;AACA,QAAMY,MAAM,GAAG,sDAAf;AACA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBhB,QAAQ,CAAC,EAAD,CAApC;AACA,QAAMiB,SAAS,GAAG,YAAlB;AACA,QAAMC,SAAS,GAAG,aAAlB;AACA,QAAMC,WAAW,GAAG,cAApB;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAkBhB,OAAO,EAA/B;AACAH,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIS,MAAM,KAAK,KAAf,EAAsB;AACpBM,MAAAA,SAAS,CAACC,SAAD,CAAT;AACD,KAFD,MAEO;AACLD,MAAAA,SAAS,CAACE,SAAD,CAAT;AACD;;AACDG,IAAAA,UAAU,CAAC,MAAM;AACfR,MAAAA,GAAG,CAACS,OAAJ,CAAYC,cAAZ,CAA2B;AAAEC,QAAAA,QAAQ,EAAE;AAAZ,OAA3B;AACD,KAFS,EAEP,GAFO,CAAV;AAGD,GATQ,EASN,CAACd,MAAD,CATM,CAAT;;AAUA,QAAMe,YAAY,GAAG,MAAOC,CAAP,IAAa;AAChCA,IAAAA,CAAC,CAACC,cAAF;AACA,UAAMC,UAAU,GAAGzB,QAAQ,CAAC0B,SAAT,GAAqBC,UAArB,CAAgC,MAAhC,CAAnB;AACA,UAAMC,IAAI,GAAG5B,QAAQ,CAAC0B,SAAT,GAAqBC,UAArB,CAAgC,OAAhC,CAAb;AACA,UAAME,aAAa,GAAG7B,QAAQ,CAAC0B,SAAT,GAAqBC,UAArB,CAAgC,YAAhC,CAAtB;AACA,UAAMG,UAAU,GAAG9B,QAAQ,CAAC0B,SAAT,GAAqBC,UAArB,CAAgC,YAAhC,CAAnB;AACA,UAAMI,cAAc,GAAG/B,QAAQ,CAAC0B,SAAT,GAAqBC,UAArB,CAAgC,gBAAhC,CAAvB;AACAC,IAAAA,IAAI,CACDI,KADH,CACS,aADT,EACwB,IADxB,EAC8BhB,WAD9B,EAEGgB,KAFH,CAES,SAFT,EAEoB,IAFpB,EAE0Bf,WAAW,CAACgB,GAFtC,EAGGC,GAHH,GAIGC,IAJH,CAISC,QAAD,IAAc;AAClB,UAAIC,KAAK,GAAG,EAAZ;AACAD,MAAAA,QAAQ,CAACE,IAAT,CAAcC,GAAd,CAAkB,MAAOC,GAAP,IAAe;AAC/BH,QAAAA,KAAK,GAAGG,GAAG,CAACC,IAAJ,EAAR;AACD,OAFD;AAGAC,MAAAA,OAAO,CAACC,GAAR,CAAYN,KAAZ;;AACA,UAAI,CAACA,KAAL,EAAY;AACVT,QAAAA,IAAI,CACDgB,GADH,CACO;AACH5B,UAAAA,WAAW,EAAEA,WADV;AAEH6B,UAAAA,SAAS,EAAErC,EAFR;AAGHsC,UAAAA,OAAO,EAAE7B,WAAW,CAACgB;AAHlB,SADP,EAMGE,IANH,CAMQ,MAAOY,MAAP,IAAkB;AACtB,gBAAMjB,UAAU,CAACU,GAAX,CAAehC,EAAf,EAAmBwC,MAAnB,CAA0B;AAC9BC,YAAAA,WAAW,EAAEjD,QAAQ,CAAC0B,SAAT,CAAmBwB,UAAnB,CAA8BC,SAA9B,CAAwC,CAAC,CAAzC;AADiB,WAA1B,CAAN;AAGA,gBAAM1B,UAAU,CACbmB,GADG,CACC;AACHC,YAAAA,SAAS,EAAErC,EADR;AAEHoB,YAAAA,IAAI,EAAEmB,MAAM,CAACvC,EAFV;AAGH4C,YAAAA,WAAW,EAAE,CAACnC,WAAW,CAACoC,KAAb;AAHV,WADD,EAMHlB,IANG,CAME,MAAOK,GAAP,IAAe;AACnB,kBAAMX,aAAa,CAACe,GAAd,CAAkB;AACtBC,cAAAA,SAAS,EAAErC,EADW;AAEtB8C,cAAAA,EAAE,EAAErC,WAAW,CAACoC,KAFM;AAGtBzB,cAAAA,IAAI,EAAEmB,MAAM,CAACvC,EAHS;AAItB+C,cAAAA,eAAe,EAAE,EAJK;AAKtBC,cAAAA,MAAM,EACJxD,QAAQ,CAAC0B,SAAT,CAAmB+B,SAAnB,CAA6BC,GAA7B,GAAmCC,QAAnC,KACA,OAAO,EAAP,GAAY,EAAZ,GAAiB,CAPG;AAQtBC,cAAAA,MAAM,EAAEpB,GAAG,CAAChC;AARU,aAAlB,CAAN;AAUD,WAjBG,CAAN;AAkBA,gBAAMuB,cAAc,CAACa,GAAf,CAAmB;AACvBiB,YAAAA,IAAI,EAAG,sCAAqCrD,EAAG,mCADxB;AAEvBsD,YAAAA,YAAY,EAAE,kBAFS;AAGvBhB,YAAAA,OAAO,EAAE7B,WAAW,CAACgB,GAHE;AAIvB8B,YAAAA,KAAK,EAAE,KAJgB;AAKvBP,YAAAA,MAAM,EAAExD,QAAQ,CAAC0B,SAAT,CAAmB+B,SAAnB,CAA6BC,GAA7B,GAAmCM,MAAnC;AALe,WAAnB,CAAN;AAOAvD,UAAAA,OAAO,CAACwD,IAAR,CAAc,eAAclB,MAAM,CAACvC,EAAG,EAAtC;AACD,SApCH,EAqCG0D,KArCH,CAqCS,MAAOC,KAAP,IAAiB;AACtBC,UAAAA,KAAK,CAACD,KAAD,CAAL;AACA,gBAAMpC,cAAc,CAACa,GAAf,CAAmB;AACvBiB,YAAAA,IAAI,EAAG,sCAAqCrD,EAAG,2BADxB;AAEvBsD,YAAAA,YAAY,EAAE,4BAFS;AAGvBhB,YAAAA,OAAO,EAAE7B,WAAW,CAACgB,GAHE;AAIvB8B,YAAAA,KAAK,EAAE;AAJgB,WAAnB,CAAN;AAMD,SA7CH;AA8CD,OA/CD,MA+CO;AACLtD,QAAAA,OAAO,CAACwD,IAAR,CAAc,eAAcjD,WAAY,EAAxC;AACD;AACF,KA5DH;AA6DAO,IAAAA,CAAC,CAACC,cAAF;AACD,GArED;;AAsEA,sBACE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA,4BACE;AAAK,MAAA,GAAG,EAAC,EAAT;AAAY,MAAA,GAAG,EAAElB,GAAjB;AAAsB,MAAA,KAAK,EAAC;AAA5B;AAAA;AAAA;AAAA;AAAA,YADF,eAEE;AAAI,MAAA,SAAS,EAAC,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFF,eAGE;AAAM,MAAA,QAAQ,EAAEgB,YAAhB;AAA8B,MAAA,SAAS,EAAC,aAAxC;AAAA,8BACE;AAAK,QAAA,GAAG,EAAC,EAAT;AAAY,QAAA,GAAG,EAAEpB,EAAjB;AAAqB,QAAA,KAAK,EAAC;AAA3B;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,KAAK,EAAES,MAA1B;AAAkC,QAAA,QAAQ,EAAE;AAA5C;AAAA;AAAA;AAAA;AAAA,cAFF,eAGE,QAAC,MAAD;AAAQ,QAAA,MAAM,EAAEC;AAAhB;AAAA;AAAA;AAAA;AAAA,cAHF,eAIE;AACE,QAAA,IAAI,EAAC,QADP;AAEE,QAAA,SAAS,EAAC,UAFZ;AAGE,QAAA,KAAK,EAAE;AAAEyD,UAAAA,KAAK,EAAE;AAAT,SAHT;AAIE,QAAA,GAAG,EAAE3D,GAJP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAJF;AAAA;AAAA;AAAA;AAAA;AAAA,YAHF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAmBD;;GA7GuBL,Q;UACPD,S,EACCD,U,EAOQF,O;;;KATFI,Q;;AA8GxB,MAAMiE,MAAM,GAAG,CAAC;AAAE1D,EAAAA;AAAF,CAAD,KAAgB;AAC7B,sBACE;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA,4BACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAEE;AAAA,gBAAKA;AAAL;AAAA;AAAA;AAAA;AAAA,YAFF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAMD,CAPD;;MAAM0D,M","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport firebase from \"../../utils/firebase\";\r\nimport { useAuth } from \"../context/authContext\";\r\nimport qr from \"../images/qr-code-example.png\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useParams } from \"react-router-dom\";\r\nexport default function Register({ img, moneda }) {\r\n  const { id } = useParams();\r\n  const history = useHistory();\r\n  const ref = useRef(null);\r\n  const wallet = \"6vuw9DbaenYyMjuBDn8bkH3Ny23b4s6mPPLq4dbuxZPDm EVo4TM\";\r\n  const [precio, setPrecio] = useState(\"\");\r\n  const preciobtc = \"0.0013 BTC\";\r\n  const precioeth = \"0.00042 ETH\";\r\n  const comprobante = \"224345q7iq19\";\r\n  const { currentUser } = useAuth();\r\n  useEffect(() => {\r\n    if (moneda === \"btc\") {\r\n      setPrecio(preciobtc);\r\n    } else {\r\n      setPrecio(precioeth);\r\n    }\r\n    setTimeout(() => {\r\n      ref.current.scrollIntoView({ behavior: \"smooth\" });\r\n    }, 500);\r\n  }, [moneda]);\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const createChat = firebase.firestore().collection(\"Chat\");\r\n    const pago = firebase.firestore().collection(\"Pagos\");\r\n    const invitacionDoc = firebase.firestore().collection(\"Invitacion\");\r\n    const conciertos = firebase.firestore().collection(\"Conciertos\");\r\n    const notificaciones = firebase.firestore().collection(\"Notificaciones\");\r\n    pago\r\n      .where(\"comprobante\", \"==\", comprobante)\r\n      .where(\"usuario\", \"==\", currentUser.uid)\r\n      .get()\r\n      .then((snapshot) => {\r\n        let match = \"\";\r\n        snapshot.docs.map(async (doc) => {\r\n          match = doc.data();\r\n        });\r\n        console.log(match);\r\n        if (!match) {\r\n          pago\r\n            .add({\r\n              comprobante: comprobante,\r\n              concierto: id,\r\n              usuario: currentUser.uid,\r\n            })\r\n            .then(async (docRef) => {\r\n              await conciertos.doc(id).update({\r\n                entradasVip: firebase.firestore.FieldValue.increment(-1),\r\n              });\r\n              await createChat\r\n                .add({\r\n                  concierto: id,\r\n                  pago: docRef.id,\r\n                  integrantes: [currentUser.email],\r\n                })\r\n                .then(async (doc) => {\r\n                  await invitacionDoc.add({\r\n                    concierto: id,\r\n                    de: currentUser.email,\r\n                    pago: docRef.id,\r\n                    usuarioInvitado: \"\",\r\n                    tiempo:\r\n                      firebase.firestore.Timestamp.now().toMillis() +\r\n                      1000 * 60 * 60 * 5,\r\n                    chatId: doc.id,\r\n                  });\r\n                });\r\n              await notificaciones.add({\r\n                info: `Solicitud de compra para concierto ${id}, ha sido procesada correctamente`,\r\n                infoHeadLine: \"Compra procesada\",\r\n                usuario: currentUser.uid,\r\n                visto: false,\r\n                tiempo: firebase.firestore.Timestamp.now().toDate(),\r\n              });\r\n              history.push(`/invitacion/${docRef.id}`);\r\n            })\r\n            .catch(async (error) => {\r\n              alert(error);\r\n              await notificaciones.add({\r\n                info: `Solicitud de compra para concierto ${id}, ha devuelto un error :/`,\r\n                infoHeadLine: \"Error para procesar compra\",\r\n                usuario: currentUser.uid,\r\n                visto: false,\r\n              });\r\n            });\r\n        } else {\r\n          history.push(`/invitacion/${comprobante}`);\r\n        }\r\n      });\r\n    e.preventDefault();\r\n  };\r\n  return (\r\n    <div className=\"form-pago\">\r\n      <img alt=\"\" src={img} width=\"100px\"></img>\r\n      <h3 className=\"title\">Formulario de pago</h3>\r\n      <form onSubmit={handleSubmit} className=\"form-layout\">\r\n        <img alt=\"\" src={qr} width=\"250px\"></img>\r\n        <input type=\"text\" value={wallet} readOnly={true} />\r\n        <Precio precio={precio} />\r\n        <button\r\n          type=\"Submit\"\r\n          className=\"primario\"\r\n          style={{ width: \"30%\" }}\r\n          ref={ref}\r\n        >\r\n          Entrar\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\nconst Precio = ({ precio }) => {\r\n  return (\r\n    <div className=\"precio\">\r\n      <h4>Precio: </h4>\r\n      <h2>{precio}</h2>\r\n    </div>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}